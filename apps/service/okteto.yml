dependencies:
  - https://github.com/okteto/movies-multi-repo

build:
  k8s-status-api:
    context: .

deploy:
  remote: false
  commands:
    - kubectl apply -f k8s.yml
    - echo "DEPLOY completed"

destroy:
  remote: false
  commands:
    - kubectl delete -f k8s.yml
    - echo "DESTROY completed"

dev:
  k8s-status-api:
    image: okteto/golang:1
    command: bash
    sync:
      - .:/usr/src/app
    volumes:
      - /go
      - /root/.cache
    securityContext:
      capabilities:
        add:
          - SYS_PTRACE
    forward:
      - 2345:2345
